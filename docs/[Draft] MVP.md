### 1. Идея и цель

Создать веб-приложение, где пользователь визуально строит и изучает дерево вариантов шахматного дебюта и может сохранить/загрузить дерево в файл.

### 2. Для кого

Игроки в шахматы, которые хотят системно запоминать и повторять дебютные варианты через визуальную структуру (дерево). Уровень игроков в основном это средний либо продвинутый

### 3. Основной сценарий (MVP-поток)

<!--1. Пользователь открывает сайт без авторизации.
2. Нажимает “Создать дерево”.
3. Добавляет первый ход белых, затем продолжает строить ветки ходов.
4. Название дерева по умолчанию устанавливается NewTree.
5. Пользователь нажимает на название дерева в левом нижнем углу и меняет название дерева на своё.
6. Автосохранение в localStorage при каждом изменении дерева.
7. Сохраняет дерево в файл (опционально).
8. При выходе с сайта пользователь получает увдомление что рекомендуется сохранить дерево в файл чтобы его не потерять.
9. Позже открывает сайт снова и продолжает работу или импортирует дерево из файла.-->

#### Play for white
1. Пользователь открывает сайт без авторизации и видит заранее созданное Example tree
2. Нажимает "New Tree"
3. В диалоговом окне вводит название дерева
4. В диалоговом окне выбирает пункт "Play for white"
5. Нажимает в центре "+"
6. Вводит первый ход за белых
7. Сохраняет ход
8. 
9. Последовательно добавляет элементы дерева
10. Автосохранение в localStorage при каждом изменении дерева.
11. 

### 4. Данные и хранение (localStorage)

4.1 Что хранится

- Список деревьев (метаданные): название, дата создания/изменения.
- Содержимое каждого дерева (название, узлы/связи и позиция на холсте).
- Технические настройки пользователя: последний открытый файл/дерево.

4.2 Где и как хранится

- Хранение только локально в браузере через localStorage.
- Облака и аккаунтов нет.

4.3 Когда сохраняется

- Автосохранение при каждом изменении дерева (добавление/удаление/редактирование).
- При закрытии вкладки рекомендация о том что созданное дерево стоит сохранить на устройсто чтобы избежать потери данных.
- По завершению работы, пользователь может сохранить дерево на своё устройство в файл.

### 5. Объекты и правила дерева (модель)

5.1 Корень и уровни

- Корень дерева — стартовая позиция (без хода), отображается как круг с “+”.
- Уровень 1 — первый ход белых, уровень 2 — ответ чёрных, далее по очереди.

5.2 Узел

- Узел хранит текст хода в шахматной нотации (пример: Nf6).
- Белый узел может иметь неограниченное количество детей (ветвлений).
- Чёрный узел может иметь только одного ребёнка.
- Узел может быть пустым.

5.3 Цвета

- Цвет узла зависит от уровня: нечётные уровни — белые (ход белых), чётные — чёрные (ход чёрных).
- Корень всегда только белый

5.4 Дерево

- Название дерева вводиться при его создании и может быть отредактировано двойным нажатием на его ячейку в списке.
- Дерево обязательно должно иметь название.

### 6. Интерфейс (экраны и элементы)

<!--6.1 Главный экран

- Сразу открывается рабочая область (холст) без модальных окон авторизации.
- В левом верхнем углу отображается список деревьев.
- Для каждого дерева в списке: кнопки “Скачать” и “Удалить”.
- Левый нижний угол кнопки "Импортировать" и "Создать дерево".
- Во время редактирования дерева в правом нижнем углу кнопка "закончить редактирование" в виде пустой галочки.
- После окончания редактирования (нажатие пустой галочки) - на её месте кнопка "Редактировать" (в виде карандаша).
- По окончанию редактирования в списке с деревьями напротив редактируемого дерева появляется кнопка "скачать".
- В режиме просмотра редактировать дерево нельзя.
- Правый верхний угол - кнопка “Информация/обратная связь”.-->

### 7. Редактор дерева (поведение на холсте)

7.1 Навигация по холсту

- Перемещение холста: зажатие левой кнопки мыши и drag.
- Масштабирование: колесо мыши, предел масштабирования x0.1 … x10.
- Перемещение узлов не предусмотрено.
- Когда пользователь двигается по полю и дерево уходит за пределы видимости - появляется кнопка чтобы вернуться на координаты 0;0.

7.2 Добавление узлов

- При наведении на существующий узел появляется маленькая кнопка-узел “+” справа от него.
- Нажатие на “+” создаёт дочерний узел и открывает ввод хода.
- При создании нового дочернего узла сначала открывается ввод хода, который можно закрыть и тогда будет создан пустой узел.

7.3 Редактирование и удаление

- ПКМ по узлу открывает меню/диалог: “Изменить ход” и “Удалить узел”.
- При удалении узла без детей уведомления не выскакивают.
- При удалении узла у которого есть дети пользователь получает уведомление "Этот узел имеет привязку других объектов. Удалить полностью всю ветку или очистить ячейку?". При закрытии окна удаление отменяется.

### 8. Импорт и экспорт

8.1 Импорт

- Кнопка “Загрузить/Импортировать”.
- После импорта дерево появляется в списке и открывается на холсте.
- При импорте дерева с таким же именем дерево добавляется в список но меняет название на "{Имя} (1)", аналогично если такое же имя будет повторяться - нумерация будет увеличиваться.

8.2 Экспорт

- Экспорт текущего дерева в файл формата .json.
- Имя файла для сохранения “<название>.json”.

### 9. Не входит в MVP

- Авторизация и аккаунты.
- Облачное хранение и синхронизация.
- Переводы на другие языки.
- Обучающие подсказки.
- Проверка на повторение узлов.
- Проверка корректности ходов в позиции.
- Подсказки ходов от Stockfish/движка.
- Комментарии и названия ходов.
- Импорт PGN в дерево.
- Иконки с фигурами напротив ходов.
- Drag&Drop файла на страницу
